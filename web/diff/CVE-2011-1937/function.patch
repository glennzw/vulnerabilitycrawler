commit 46e3d3ad195dcdc1af1795c96b6e0dc778fb6881
Author: Jamie Cameron <jcameron@webmin.com>
Date:   Sat Apr 23 18:03:29 2011 -0700

    Fix possible XSS attack due to user's real name not being escaped

diff --git a/useradmin/user-lib.pl b/useradmin/user-lib.pl
index 8f231bf..facf257 100755
--- a/useradmin/user-lib.pl
+++ b/useradmin/user-lib.pl
@@ -2312,19 +2312,19 @@ local $u;
 foreach $u (@$users) {
 	$u->{'real'} =~ s/,.*$// if ($config{'extra_real'} ||
 				     $u->{'real'} =~ /,$/);
 	local @cols;
 	push(@cols, "") if ($anyedit && $u->{'noedit'});
 	push(@cols, &user_link($u));
 	push(@cols, $u->{'uid'});
-	push(@cols, $gidgrp{$u->{'gid'}}||$u->{'gid'});
-	push(@cols, $u->{'real'});
-	push(@cols, $u->{'home'});
-	push(@cols, $u->{'shell'});
-	push(@cols, $llogin{$u->{'user'}}) if ($lshow);
+	push(@cols, $gidgrp{$u->{'gid'}} || $u->{'gid'});
+	push(@cols, &html_escape($u->{'real'}));
+	push(@cols, &html_escape($u->{'home'}));
+	push(@cols, &html_escape($u->{'shell'}));
+	push(@cols, &html_escape($llogin{$u->{'user'}})) if ($lshow);
 	if ($u->{'noedit'}) {
 		print &ui_columns_row(\@cols, \@tds);
 		}
 	else {
 		print &ui_checked_columns_row(\@cols, \@tds, "d", $u->{'user'});
 		}
 	}
@@ -2380,21 +2380,21 @@ local $g;
 foreach $g (@$groups) {
 	local $members = join(" ", split(/,/, $g->{'members'}));
 	local @cols;
 	if ($anyedit && ($g->{'noedit'} || !$access{'gdelete'})) {
 		# Need an explicity blank first column
 		push(@cols, "");
 		}
 	push(@cols, &group_link($g));
 	push(@cols, $g->{'gid'});
 	if ($anydesc) {
-		push(@cols, $g->{'desc'});
+		push(@cols, &html_escape($g->{'desc'}));
 		}
 	push(@cols, &html_escape($members));
 	if ($g->{'noedit'} || !$access{'gdelete'}) {
 		print &ui_columns_row(\@cols, \@tds);
 		}
 	else {
 		print &ui_checked_columns_row(\@cols, \@tds, "gd",
 					      $g->{'group'});
 		}
 	}
