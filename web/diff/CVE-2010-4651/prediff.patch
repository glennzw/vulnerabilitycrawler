   Do not let a malicious patch create files above current directory
   
   This addresses CVE-2010-4651, reported by Jakub Wilk.
   https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2010-4651
   * src/util.c (strip_leading_slashes): Reject absolute file names
   and file names containing a component of "..".
   * tests/bad-filenames: New file.  Test for this.
   * tests/Makefile.am (TESTS): Add it.
   Improvements by Andreas Gruenbacher.
2010-12-04  Andreas Gruenbacher <agruen@linbit.com>

	* src/util.c (make_tempfile): Create missing directories when
Copyright (C) 1984, 1985, 1986, 1987, 1988 Larry Wall.

Copyright (C) 1989, 1990, 1991, 1992, 1993, 1997, 1998, 1999, 2000, 2001,
2002, 2009, 2010 Free Software Foundation, Inc.

This file is part of GNU Patch.

/* Copyright (C) 1986, 1987, 1988 Larry Wall

   Copyright (C) 1990, 1991, 1992, 1993, 1997, 1998, 1999, 2000, 2001,
   2002, 2003, 2006, 2009, 2010 Free Software Foundation, Inc.

   This program is free software: you can redistribute it and/or modify
   it under the terms of the GNU General Public License as published by
/* Copyright (C) 1986 Larry Wall

   Copyright (C) 1992, 1993, 1997, 1998, 1999, 2001, 2002, 2003, 2006,
   2009, 2010 Free Software Foundation, Inc.

   This program is free software: you can redistribute it and/or modify
   it under the terms of the GNU General Public License as published by
	      n = p+1;
	}
    }
  if ((strip_leading < 0 || s <= 0) && *n)
    {
      memmove (name, n, strlen (n) + 1);
# Copyright (C) 1989, 1990, 1991, 1992, 1993, 1997, 1998, 1999, 2002,
# 2003, 2006, 2009, 2010 Free Software Foundation, Inc.

# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
TESTS = \
	asymmetric-hunks \
	backup-prefix-suffix \
	copy-rename \
	corrupt-reject-files \
	create-delete \
