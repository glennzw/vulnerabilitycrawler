   Properly escape glob characters.
    # Helper for building query glob string based on resolver's pattern.
    def build_query(path, details)
      query = @pattern.dup
      query.gsub!(/\:prefix(\/)?/, path.prefix.empty? ? "" : "#{path.prefix}\\1") # prefix can be empty...
      query.gsub!(/\:action/, path.partial? ? "_#{path.name}" : path.name)

      details.each do |ext, variants|
        query.gsub!(/\:#{ext}/, "{#{variants.compact.uniq.join(',')}}")
      File.expand_path(query, @path)
    end

    # Returns the file mtime from the filesystem.
    def mtime(p)
      File.mtime(p)
  class OptimizedFileSystemResolver < FileSystemResolver #:nodoc:
    def build_query(path, details)
      exts = EXTENSIONS.map { |ext| details[ext] }

      File.join(@path, path) + exts.map { |ext|
        "{#{ext.compact.uniq.map { |e| ".#{e}," }.join}}"
      }.join
    end
    render :template => "test/hello_world"
  end

  def render_with_explicit_string_template
    render "test/hello_world"
  end
    assert_response :success
  end

  def test_render_with_explicit_string_template
    get :render_with_explicit_string_template
    assert_equal "<html>Hello world!</html>", @response.body
