commit 476e4926e2773588eab10dd3036f27e1411521b5
Author: Brendan Abbott <brendan@bloodbone.ws>
Date:   Sat Oct 1 12:16:23 2011 +1000

    Fix potential security holes reported by Mavituna Security.

diff --git a/symphony/content/content.publish.php b/symphony/content/content.publish.php
index bc56499..6808f97 100644
--- a/symphony/content/content.publish.php
+++ b/symphony/content/content.publish.php
@@ -75,15 +75,15 @@
 				}
 
 				foreach($filters as $handle => $value) {
-
-					$field_id = Symphony::Database()->fetchVar('id', 0, sprintf(
-						"SELECT `f`.`id`
-						FROM `tbl_fields` AS `f`, `tbl_sections` AS `s`
-						WHERE `s`.`id` = `f`.`parent_section`
-						AND f.`element_name` = '%s'
+					$field_id = Symphony::Database()->fetchVar('id', 0, sprintf("
+						SELECT `f`.`id`
+						FROM `tbl_fields` AS `f`
+						LEFT JOIN `tbl_sections` AS `s` ON (`s`.`id` = `f`.`parent_section`)
+						WHERE f.`element_name` = '%s'
 						AND `s`.`handle` = '%s'
-						LIMIT 1",
-						$handle,
+						LIMIT 1
+					",
+						Symphony::Database()->cleanValue($handle),
 						$section->get('handle'))
 					);
 
@@ -98,7 +98,6 @@
 					} else {
 						unset($filters[$i]);
 					}
-
 				}
 
 				$filter_querystring = preg_replace("/&amp;$/", '', $filter_querystring);
diff --git a/symphony/lib/toolkit/class.devkit.php b/symphony/lib/toolkit/class.devkit.php
index e7068f4..5a45dd0 100644
--- a/symphony/lib/toolkit/class.devkit.php
+++ b/symphony/lib/toolkit/class.devkit.php
@@ -258,6 +258,7 @@
 		 */
 		public function build() {
 			$this->buildIncludes();
+			$this->_view = General::sanitize($this->_view);
 
 			$header = new XMLElement('div');
 			$header->setAttribute('id', 'header');
