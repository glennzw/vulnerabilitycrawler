   Fix: Sanitize PHP_SELF
	}
}

// Security: SQL Injection and XSS Injection (scripts) protection (Filters on GET, POST)
function test_sql_and_script_inject($val,$get)
{
	$sql_inj = 0;
	// For SQL Injection
	$sql_inj += preg_match('/delete[\s]+from/i', $val);
	$sql_inj += preg_match('/create[\s]+table/i', $val);
	$sql_inj += preg_match('/update.+set.+=/i', $val);
	$sql_inj += preg_match('/insert[\s]+into/i', $val);
	$sql_inj += preg_match('/select.+from/i', $val);
	$sql_inj += preg_match('/union.+select/i', $val);
	$sql_inj += preg_match('/(\.\.%2f)+/i', $val);
	// For XSS Injection done by adding javascript with script
	$sql_inj += preg_match('/<script/i', $val);
	$sql_inj += preg_match('/base[\s]+href/i', $val);
	if ($get) $sql_inj += preg_match('/img[\s]+src/i', $val);
	if ($get) $sql_inj += preg_match('/style[\s]*=/i', $val);
	if ($get) $sql_inj += preg_match('/javascript:/i', $val);
	// For XSS Injection done by adding javascript with onmousemove, etc... (closing a src or href tag with not cleaned param)
	if ($get) $sql_inj += preg_match('/"/i', $val);	// We refused " in GET parameters value
	return $sql_inj;
}
// Security: Return true if OK, false otherwise
if (! empty($_SERVER["PHP_SELF"]))
{
    $morevaltochecklikepost=array($_SERVER["PHP_SELF"]);
    analyse_sql_and_script($morevaltochecklikepost,0);
}
// Sanity check on GET parameters
if (! empty($_SERVER["QUERY_STRING"]))
