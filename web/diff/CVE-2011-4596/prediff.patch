   Sanitize EC2 manifests and image tarballs
   
   Prevent potential directory traversal with malicious EC2 image tarballs,
   by making sure the tarfile is safe before unpacking it. Fixes bug 894755
   
   Prevent potential directory traversal with malicious file names in
   EC2 image manifests. Fixes bug 885167
   
   Change-Id: If6109047307bd6e654ee9d1254f0d7f31cf741c1
include nova/tests/bundle/1mb.part.1
include nova/tests/api/ec2/public_key/*
include nova/tests/db/nova.austin.sqlite
include plugins/xenapi/README
include plugins/xenapi/etc/xapi.d/plugins/objectstore
include plugins/xenapi/etc/xapi.d/plugins/pluginlib_nova.py
    @staticmethod
    def _download_file(bucket, filename, local_dir):
        key = bucket.get_key(filename)
        local_filename = os.path.join(local_dir, filename)
        key.get_contents_to_filename(local_filename)
        return local_filename

                                     'err': err})

    @staticmethod
    def _untarzip_image(path, filename):
        tar_file = tarfile.open(filename, 'r|gz')
        tar_file.extractall(path)
        image_file = tar_file.getnames()[0]
#    License for the specific language governing permissions and limitations
#    under the License.

from nova import context
import nova.db.api
from nova import exception
            {'device_name': '/dev/sdb0',
             'no_device': True}]
        self.assertEqual(block_device_mapping, expected_bdm)
