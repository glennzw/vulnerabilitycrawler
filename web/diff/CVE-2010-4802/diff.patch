commit b3a1fb453eda447c0bb082cd9eed81bb75a7564a
Author: Sebastian Riedel <sri@labs.kraih.com>
Date:   Tue Aug 17 15:40:29 2010 +0200

    fixed CGI environment detection for broken web servers

diff --git a/Changes b/Changes
index 872b282..ff57177 100644
--- a/Changes
+++ b/Changes
@@ -1,6 +1,7 @@
 This file documents the revision history for Perl extension Mojolicious.
 
 0.999928 2010-08-15 00:00:00
+        - Fixed CGI environment detection for broken web servers.
         - Fixed redirect_to without content and render_static bug.
         - Fixed nested partial rendering bug. (yko)
         - Fixed multiple small Mojo::DOM bugs. (yko)
diff --git a/lib/Mojo/Commands.pm b/lib/Mojo/Commands.pm
index 87abd4b..e64ccdd 100644
--- a/lib/Mojo/Commands.pm
+++ b/lib/Mojo/Commands.pm
@@ -145,9 +145,6 @@ sub _detect {
     # PSGI (Plack only for now)
     return 'psgi' if defined $ENV{PLACK_ENV};
 
-    # No further detection if we have a name
-    return $name if $name;
-
     # CGI
     return 'cgi'
       if defined $ENV{PATH_INFO} || defined $ENV{GATEWAY_INTERFACE};
@@ -156,7 +153,7 @@ sub _detect {
     return 'fastcgi' unless defined $ENV{PATH};
 
     # Nothing
-    return;
+    return $name;
 }
 
 1;
