commit 60ed93621ff36d9731ba5d9f9336d6eb91122302
Author: Avi Rozen <avi.rozen@gmail.com>
Date:   Wed Nov 19 14:40:13 2008 +0200

    fix potential buffer overflow in GetNextLine (closes: #506179)

diff --git a/debian/patches/getnextline-buffer-overflow.diff b/debian/patches/getnextline-buffer-overflow.diff
new file mode 100644
index 0000000..e239727
--- /dev/null
+++ b/debian/patches/getnextline-buffer-overflow.diff
@@ -0,0 +1,51 @@
+Index: no-ip/noip2.c
+===================================================================
+--- no-ip.orig/noip2.c	2008-11-19 14:38:20.000000000 +0200
++++ no-ip/noip2.c	2008-11-19 14:38:28.000000000 +0200
+@@ -482,7 +482,7 @@
+ int	yesno(char *fmt, ...);
+ int	add_to_request(int kind, char *p);
+ int	get_update_selection(int tgrp, int thst);
+-int	GetNextLine(char *dest);
++int	GetNextLine(char *dest, int len);
+ void SkipHeaders();
+ void	url_encode(char *in, char *out);
+ void	get_credentials(char *l, char *p);
+@@ -1552,7 +1552,7 @@
+ 	offset = 0;
+ 	SkipHeaders();
+ 	response = 0;
+-	while (GetNextLine(tbuf)) {
++	while (GetNextLine(tbuf, sizeof(tbuf))) {
+ 	    p = ourname = tbuf;	// ourname points at the host/group or error
+ 	    is_group = 1;
+ 	    while (*p && (*p != ':')) {
+@@ -2001,7 +2001,7 @@
+ 	return;
+ }
+ //////////////////////////////////////////////////////////////////////////
+-int GetNextLine(char *dest)
++int GetNextLine(char *dest, int len)
+ {
+         char    *p = &buffer[offset];
+         char    *q = dest;
+@@ -2012,8 +2012,9 @@
+         }
+         while (*p) {
+             *q++ = *p;
++            len--;
+             offset++;
+-            if (*p == '\n')  {
++            if (*p == '\n' || len == 0)  {
+                 *q = 0;
+ //fprintf(stderr, "LINE = %s", dest);
+                 return 1;
+@@ -2347,7 +2348,7 @@
+         groups->nlink = NULL;
+ 
+ 	SkipHeaders();
+-        while (GetNextLine(line)) {
++        while (GetNextLine(line, sizeof(line))) {
+             p = line;
+ 	    s = settings;
+             while (strncmp(p, s->keyword, s->len) != 0) 
diff --git a/debian/patches/series b/debian/patches/series
index b08507d..3bfa3fe 100644
--- a/debian/patches/series
+++ b/debian/patches/series
@@ -1,3 +1,4 @@
+getnextline-buffer-overflow.diff
 makefile_modifications.diff
 conffile_path_lookup.diff
 fix_segfault_conf_unreadable.diff
