   Security issue: add validation of script names
   
   This patch unifies the search for external script to always go through
   utils.FindFile and implements in that function a restriction on valid
   chars in file names and (additionally) that the passed name is the
   basename of the final (absolute) name.
   
   Signed-off-by: Iustin Pop <iustin@google.com>
   Reviewed-by: Michael Hanselmann <hansmi@google.com>
  """
  if base_dir is None:
    os_dir = utils.FindFile(name, constants.OS_SEARCH_PATH, os.path.isdir)
    if os_dir is None:
      raise errors.InvalidOS(name, None, "OS dir not found in search path")
  else:
    os_dir = os.path.sep.join([base_dir, name])

  api_versions = _OSOndiskVersion(name, os_dir)

  @return: full path to the object if found, None otherwise

  """
  for dir_name in search_path:
    item_name = os.path.sep.join([dir_name, name])
    if test(item_name):
      return item_name
  return None

