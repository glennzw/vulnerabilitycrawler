commit d09fd04ed7bfcf7f008360c6a42025108925df09
Author: Ondřej Surý <ondrej@sury.org>
Date:   Fri Mar 18 13:40:48 2011 +0100

    CVE-2011-0441: Be more careful when removing session files (Closes: #618489)

diff --git a/debian/php5-common.php5.cron.d b/debian/php5-common.php5.cron.d
index a4e73a8..f3fba39 100644
--- a/debian/php5-common.php5.cron.d
+++ b/debian/php5-common.php5.cron.d
@@ -4,4 +4,4 @@
 #  files, or 24 minutes if not defined.  See /usr/lib/php5/maxlifetime
 
 # Look for and purge old sessions every 30 minutes
-09,39 *     * * *     root   [ -x /usr/lib/php5/maxlifetime ] && [ -d /var/lib/php5 ] && find /var/lib/php5/ -type f -cmin +$(/usr/lib/php5/maxlifetime) -print0 | xargs -n 200 -r -0 rm
+09,39 *     * * *     root   [ -x /usr/lib/php5/maxlifetime ] && [ -d /var/lib/php5 ] && find /var/lib/php5/ -depth -mindepth 1 -maxdepth 1 -type f -cmin +$(/usr/lib/php5/maxlifetime) -delete
