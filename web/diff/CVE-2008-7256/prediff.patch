   nfsd: fix vm overcommit crash fix #2
   
   The previous patch from Alan Cox ("nfsd: fix vm overcommit crash",
   commit 731572d39fcd3498702eda4600db4c43d51e0b26) fixed the problem where
   knfsd crashes on exported shmemfs objects and strict overcommit is set.
   
   But the patch forgot supporting the case when CONFIG_SECURITY is
   disabled.
   
   This patch copies a part of his fix which is mainly for detecting a bug
   earlier.
   
   Acked-by: James Morris <jmorris@namei.org>
   Signed-off-by: Alan Cox <alan@redhat.com>
   Signed-off-by: Junjiro R. Okajima <hooanon05@yahoo.co.jp>
   Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
   Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

static inline int security_vm_enough_memory(long pages)
{
	return cap_vm_enough_memory(current->mm, pages);
}

static inline int security_vm_enough_memory_kern(long pages)
{
	return cap_vm_enough_memory(current->mm, pages);
}

static inline int security_vm_enough_memory_mm(struct mm_struct *mm, long pages)
{
	return cap_vm_enough_memory(mm, pages);
}

static inline int security_bprm_alloc(struct linux_binprm *bprm)
