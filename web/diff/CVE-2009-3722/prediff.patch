   KVM: VMX: Check cpl before emulating debug register access
   
   Debug registers may only be accessed from cpl 0.  Unfortunately, vmx will
   code to emulate the instruction even though it was issued from guest
   userspace, possibly leading to an unexpected trap later.
   
   Cc: stable@kernel.org
   Signed-off-by: Avi Kivity <avi@redhat.com>
   Signed-off-by: Marcelo Tosatti <mtosatti@redhat.com>
void kvm_queue_exception_e(struct kvm_vcpu *vcpu, unsigned nr, u32 error_code);
void kvm_inject_page_fault(struct kvm_vcpu *vcpu, unsigned long cr2,
			   u32 error_code);

int kvm_pic_set_irq(void *opaque, int irq, int level);

	unsigned long val;
	int dr, reg;

	dr = vmcs_readl(GUEST_DR7);
	if (dr & DR7_GD) {
		/*
EXPORT_SYMBOL_GPL(kvm_queue_exception_e);

/*
 * Load the pae pdptrs.  Return true is they are all valid.
 */
int load_pdptrs(struct kvm_vcpu *vcpu, unsigned long cr3)
