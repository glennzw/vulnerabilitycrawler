commit 82e68f7ffec3800425f2391c8c86277606860442
Author: Willy Tarreau <w@1wt.eu>
Date:   Sat Aug 2 18:25:16 2008 +0200

    sound: ensure device number is valid in snd_seq_oss_synth_make_info
    
    snd_seq_oss_synth_make_info() incorrectly reports information
    to userspace without first checking for the validity of the
    device number, leading to possible information leak (CVE-2008-3272).
    
    Reported-By: Tobias Klein <tk@trapkit.de>
    Acked-and-tested-by: Takashi Iwai <tiwai@suse.de>
    Cc: stable@kernel.org
    Signed-off-by: Willy Tarreau <w@1wt.eu>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

diff --git a/sound/core/seq/oss/seq_oss_synth.c b/sound/core/seq/oss/seq_oss_synth.c
index 558dadb..e024e45 100644
--- a/sound/core/seq/oss/seq_oss_synth.c
+++ b/sound/core/seq/oss/seq_oss_synth.c
@@ -603,30 +603,33 @@ int
 snd_seq_oss_synth_make_info(struct seq_oss_devinfo *dp, int dev, struct synth_info *inf)
 {
 	struct seq_oss_synth *rec;
 
+	if (dev < 0 || dev >= dp->max_synthdev)
+		return -ENXIO;
+
 	if (dp->synths[dev].is_midi) {
 		struct midi_info minf;
 		snd_seq_oss_midi_make_info(dp, dp->synths[dev].midi_mapped, &minf);
 		inf->synth_type = SYNTH_TYPE_MIDI;
 		inf->synth_subtype = 0;
 		inf->nr_voices = 16;
 		inf->device = dev;
 		strlcpy(inf->name, minf.name, sizeof(inf->name));
 	} else {
 		if ((rec = get_synthdev(dp, dev)) == NULL)
 			return -ENXIO;
 		inf->synth_type = rec->synth_type;
 		inf->synth_subtype = rec->synth_subtype;
 		inf->nr_voices = rec->nr_voices;
 		inf->device = dev;
 		strlcpy(inf->name, rec->name, sizeof(inf->name));
 		snd_use_lock_free(&rec->use_lock);
 	}
 	return 0;
 }
 
 
 #ifdef CONFIG_PROC_FS
 /*
  * proc interface
  */
