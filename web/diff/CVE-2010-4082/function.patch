commit b4aaa78f4c2f9cde2f335b14f4ca30b01f9651ca
Author: Dan Rosenberg <drosenberg@vsecurity.com>
Date:   Wed Sep 15 19:08:24 2010 -0400

    drivers/video/via/ioctl.c: prevent reading uninitialized stack memory
    
    The VIAFB_GET_INFO device ioctl allows unprivileged users to read 246
    bytes of uninitialized stack memory, because the "reserved" member of
    the viafb_ioctl_info struct declared on the stack is not altered or
    zeroed before being copied back to the user.  This patch takes care of
    it.
    
    Signed-off-by: Dan Rosenberg <dan.j.rosenberg@gmail.com>
    Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>

diff --git a/drivers/video/via/ioctl.c b/drivers/video/via/ioctl.c
index da03c07..4d553d0 100644
--- a/drivers/video/via/ioctl.c
+++ b/drivers/video/via/ioctl.c
@@ -24,55 +24,57 @@
 int viafb_ioctl_get_viafb_info(u_long arg)
 {
 	struct viafb_ioctl_info viainfo;
 
+	memset(&viainfo, 0, sizeof(struct viafb_ioctl_info));
+
 	viainfo.viafb_id = VIAID;
 	viainfo.vendor_id = PCI_VIA_VENDOR_ID;
 
 	switch (viaparinfo->chip_info->gfx_chip_name) {
 	case UNICHROME_CLE266:
 		viainfo.device_id = UNICHROME_CLE266_DID;
 		break;
 
 	case UNICHROME_K400:
 		viainfo.device_id = UNICHROME_K400_DID;
 		break;
 
 	case UNICHROME_K800:
 		viainfo.device_id = UNICHROME_K800_DID;
 		break;
 
 	case UNICHROME_PM800:
 		viainfo.device_id = UNICHROME_PM800_DID;
 		break;
 
 	case UNICHROME_CN700:
 		viainfo.device_id = UNICHROME_CN700_DID;
 		break;
 
 	case UNICHROME_CX700:
 		viainfo.device_id = UNICHROME_CX700_DID;
 		break;
 
 	case UNICHROME_K8M890:
 		viainfo.device_id = UNICHROME_K8M890_DID;
 		break;
 
 	case UNICHROME_P4M890:
 		viainfo.device_id = UNICHROME_P4M890_DID;
 		break;
 
 	case UNICHROME_P4M900:
 		viainfo.device_id = UNICHROME_P4M900_DID;
 		break;
 	}
 
 	viainfo.version = VERSION_MAJOR;
 	viainfo.revision = VERSION_MINOR;
 
 	if (copy_to_user((void __user *)arg, &viainfo, sizeof(viainfo)))
 		return -EFAULT;
 
 	return 0;
 }
 
 /* Hot-Plug Priority: DVI > CRT*/
