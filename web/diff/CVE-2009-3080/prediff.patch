   [SCSI] gdth: Prevent negative offsets in ioctl CVE-2009-3080
   
   A negative offset could be used to index before the event buffer and
   lead to a security breach.
   
   Signed-off-by: Dave Jones <davej@redhat.com>
   Cc: Stable Tree <stable@kernel.org>
   Signed-off-by: James Bottomley <James.Bottomley@suse.de>
        eindex = handle;
    estr->event_source = 0;

    if (eindex >= MAX_EVENTS) {
        spin_unlock_irqrestore(&ha->smp_lock, flags);
        return eindex;
    }
