commit a9986b86c53de0582248b39605660fbba0c21a29
Author: Frederik Heyninck <frederikheyninck@gmail.com>
Date:   Mon Feb 13 16:13:35 2012 +0100

    XSS / LFI Fox

diff --git a/frontend/core/engine/javascript.php b/frontend/core/engine/javascript.php
index 8de2378..b25b0a1 100644
--- a/frontend/core/engine/javascript.php
+++ b/frontend/core/engine/javascript.php
@@ -194,6 +194,17 @@ class FrontendJavascript
 	 */
 	private function setModule($value)
 	{
+		$modules = (array) FrontendModel::getModules();
+		
+		if(!in_array((string) $value, $modules))
+		{
+			// when debug is on throw an exception
+			if(SPOON_DEBUG) throw new FrontendException('Invalid file.');
+
+			// when debug is of show a descent message
+			else exit(SPOON_DEBUG_MESSAGE);
+		}
+		
 		$this->module = (string) $value;
 	}
 }
