commit 035c8587c0d8d307e45f1b7171a0d337bb451f1e
Author: Zoltan Varga <vargaz@gmail.com>
Date:   Tue Jan 18 16:41:37 2011 +0100

    Allow only primitive types/enums in RuntimeHelpers.InitializeArray ().

diff --git a/mono/metadata/icall.c b/mono/metadata/icall.c
index ec2daf5..b757912 100644
--- a/mono/metadata/icall.c
+++ b/mono/metadata/icall.c
@@ -854,12 +854,9 @@ ves_icall_System_Runtime_CompilerServices_RuntimeHelpers_InitializeArray (MonoAr
 	int align;
 	const char *field_data;
 
-	if (MONO_TYPE_IS_REFERENCE (type) ||
-			(type->type == MONO_TYPE_VALUETYPE &&
-				(!mono_type_get_class (type) ||
-				mono_type_get_class (type)->has_references))) {
+	if (MONO_TYPE_IS_REFERENCE (type) || type->type == MONO_TYPE_VALUETYPE) {
 		MonoException *exc = mono_get_exception_argument("array",
-			"Cannot initialize array containing references");
+			"Cannot initialize array of non-primitive type.");
 		mono_raise_exception (exc);
 	}
 
