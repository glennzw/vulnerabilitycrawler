   Discard job body bytes if the job is too big.
   
   Previously, a malicious user could craft a job payload and inject
   beanstalk commands without the client application knowing. (An
   extra-careful client library could check the size of the job body before
   sending the put command, but most libraries do not do this, nor should
   they have to.)
   
   Reported by Graham Barr.
  exit 2
fi

start_beanstalkd

# Run the test
fgrep -v "#" $commands | $nc $server $port > "$tmpf"
        if (errno) return reply_msg(c, MSG_BAD_FORMAT);

        if (body_size > job_data_size_limit) {
            return reply_msg(c, MSG_JOB_TOO_BIG);
        }

        /* don't allow trailing garbage */
